// ... (ØªØ§Ø¨Ø¹ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù…Ù† Ø§Ù„Ø¯Ø§Ù„Ø© renderAdminProducts)

        function renderAdminProducts() {
            const container = document.getElementById('admin-products-list');
            container.innerHTML = db.products.map(p => `
                <div class="flex justify-between items-center bg-gray-50 p-3 rounded border">
                    <div>
                        <p class="font-bold text-sm">${p.name}</p>
                        <p class="text-xs text-gray-500">${p.price} Ø¯Ø±Ù‡Ù… (Ø¹Ù…ÙˆÙ„Ø© ${p.comm} Ø¯Ø±Ù‡Ù…)</p>
                    </div>
                    <button onclick="adminDeleteProduct(${p.id})" class="text-red-500 hover:text-red-700 text-lg"><i class="fas fa-trash-alt"></i></button>
                </div>
            `).join('');
        }

        function adminAddProduct() {
            const name = document.getElementById('prod-name').value;
            const price = parseInt(document.getElementById('prod-price').value);
            const comm = parseInt(document.getElementById('prod-comm').value);
            const img = document.getElementById('prod-img').value || "https://via.placeholder.com/150?text=SatFix";

            if (!name || isNaN(price) || isNaN(comm)) {
                return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø¹Ù…ÙˆÙ„Ø© Ø¨Ø£Ø±Ù‚Ø§Ù… ØµØ­ÙŠØ­Ø©.");
            }

            db.products.push({
                id: Date.now(),
                name, price, comm, img
            });
            saveData();
            renderAdminProducts();
            document.getElementById('prod-name').value = '';
            document.getElementById('prod-price').value = '';
            document.getElementById('prod-comm').value = '';
            document.getElementById('prod-img').value = '';
            alert("âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­.");
        }

        function adminDeleteProduct(id) {
            if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ")) {
                db.products = db.products.filter(p => p.id !== id);
                saveData();
                renderAdminProducts();
                // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø§Øª Ø§Ù„Ø²Ø¨ÙˆÙ† ÙˆØ§Ù„ÙÙ†ÙŠ Ø£ÙŠØ¶Ù‹Ø§ ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø°Ù
                if (currentUserRole === 'client') renderClientProducts();
                if (currentUserRole === 'tech') renderTechProducts();
            }
        }

        // === 6. Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ÙˆÙ„ÙŠ ===
        document.addEventListener('DOMContentLoaded', () => {
            // ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø¯ÙˆØ± Ù…Ø­ÙÙˆØ¸ (Ù„Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø³Ø±ÙŠØ¹Ø© Ø¨Ø¹Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„)
            const storedRole = sessionStorage.getItem('current_user_role');
            if (storedRole && storedRole !== 'null') {
                loginAs(storedRole);
            } else {
                 // Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø¯ÙˆØ± Ù…Ø­ÙÙˆØ¸
                 document.getElementById('login-screen').classList.remove('hidden');
            }
        });

        function loginAs(role) {
            currentUserRole = role;
            // Ø­ÙØ¸ Ø§Ù„Ø¯ÙˆØ± ÙÙŠ sessionStorage Ù„ØªØ°ÙƒØ± Ø¢Ø®Ø± Ø¯Ø®ÙˆÙ„ Ø¨Ø¹Ø¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            sessionStorage.setItem('current_user_role', role);
            
            document.getElementById('login-screen').classList.add('hidden');
            
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
            document.getElementById('client-panel').classList.add('hidden-section');
            document.getElementById('tech-panel').classList.add('hidden-section');
            document.getElementById('admin-panel').classList.add('hidden-section');

            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (role === 'client') {
                document.getElementById('client-panel').classList.remove('hidden-section');
                document.getElementById('user-role-badge').innerText = "Ø²Ø¨ÙˆÙ†";
                renderClientProducts();
            } else if (role === 'tech') {
                document.getElementById('tech-panel').classList.remove('hidden-section');
                document.getElementById('user-role-badge').innerText = "ÙÙ†ÙŠ";
                updateTechWallet();
                renderTechProducts();
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø±Ø¶ Ù‚Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙƒØ§ÙØªØ±Ø§Ø¶ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙÙ†ÙŠ
                switchTechTab('products');
            } else if (role === 'admin') {
                document.getElementById('admin-panel').classList.remove('hidden-section');
                document.getElementById('user-role-badge').innerText = "Ù…Ø¯ÙŠØ±";
                renderAdminStats();
                renderAdminProducts();
            }
        }

        function logout() {
            sessionStorage.removeItem('current_user_role');
            location.reload();
        }

        // === 7. ÙˆØ¸ÙŠÙØ© ÙˆÙ‡Ù…ÙŠØ© Ù„Ø·Ù„Ø¨ Ø³Ø­Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ (Ù„Ù„ÙÙ†ÙŠ) ===
        function requestPayout() {
            if (db.techWallet === 0) {
                return alert("âš ï¸ Ø±ØµÙŠØ¯Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù‡Ùˆ ØµÙØ± Ø¯Ø±Ù‡Ù…. Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø³Ø­Ø¨.");
            }
            if(confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø³Ø­Ø¨ Ø±ØµÙŠØ¯ Ø¨Ù‚ÙŠÙ…Ø© ${db.techWallet} Ø¯Ø±Ù‡Ù…ØŸ Ø³ÙŠØªÙ… Ø®ØµÙ… Ø§Ù„Ù…Ø¨Ù„Øº Ù…Ù† Ø±ØµÙŠØ¯Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ.`)) {
                alert("ğŸ“ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©! Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹.");
                db.techWallet = 0; // ÙŠØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯ Ø¨Ø¹Ø¯ ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨
                saveData();
                updateTechWallet();
            }
        }
        
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const techPanel = document.getElementById('tech-panel');
            if (techPanel) {
                // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø³Ø­Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø£Ø³ÙÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø­ÙØ¸Ø©
                const walletDiv = document.querySelector('#tech-panel .bg-gray-800');
                if (walletDiv) {
                    const payoutButton = document.createElement('button');
                    payoutButton.setAttribute('onclick', 'requestPayout()');
                    payoutButton.className = 'absolute bottom-3 left-3 bg-green-600 text-white text-xs px-3 py-1 rounded-full hover:bg-green-700 transition';
                    payoutButton.innerHTML = '<i class="fas fa-hand-holding-usd ml-1"></i> Ø³Ø­Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­';
                    walletDiv.appendChild(payoutButton);
                }
            }
        });
    </script>
</body>
</html>
